# ğŸ¥ Wateen â€” 12-Week Implementation Plan
### A Simplified Medical Booking Platform for the Egyptian Market

> **Project Type:** Educational MVP â€” Directory & Booking System  
> **Tech Stack:** Python (Flask) Â· SQLite Â· HTML5/CSS3 Â· Vanilla JavaScript  
> **Team Size:** 7 First-Year CS Students  
> **Duration:** 12 Weeks (3 Phases)

---

## Table of Contents
1. [System Architecture](#1-system-architecture)
2. [Database Schema](#2-database-schema)
3. [Weekly Work Breakdown](#3-weekly-work-breakdown-12-weeks)
4. [Technical Guidance Notes](#4-technical-guidance-notes)

---

## 1. System Architecture

### 1.1 High-Level Overview

CareLite follows a classic **3-Tier Architecture** â€” the simplest and most educational pattern for beginners:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CLIENT (Browser)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  HTML Pages   â”‚  â”‚   CSS Styles     â”‚  â”‚  Vanilla JS      â”‚   â”‚
â”‚  â”‚  (Structure)  â”‚  â”‚   (Appearance)   â”‚  â”‚  (Fetch API)     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                                         â”‚             â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ HTTP Requests â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚  JSON (REST API)
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     SERVER (Flask â€” Python)                      â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  API Routes  â”‚  â”‚  Business Logic  â”‚  â”‚   AI Modules     â”‚   â”‚
â”‚  â”‚  /api/auth   â”‚  â”‚  booking_logic   â”‚  â”‚   smart_rating   â”‚   â”‚
â”‚  â”‚  /api/nurse  â”‚  â”‚  search_engine   â”‚  â”‚   face_verify    â”‚   â”‚
â”‚  â”‚  /api/book   â”‚  â”‚  rating_calc     â”‚  â”‚   (imported)     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                   â”‚                      â”‚            â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                             â”‚                                   â”‚
â”‚                             â–¼                                   â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚                    â”‚  SQLite Database â”‚                           â”‚
â”‚                    â”‚  carelite.db     â”‚                           â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 How the Parts Connect

| Layer | Technology | Role |
|-------|-----------|------|
| **Frontend** | HTML5, CSS3, Vanilla JS | Renders the UI in Arabic (RTL), sends `fetch()` requests to the API |
| **Flask API** | Python Flask | Receives HTTP requests, runs logic, queries DB, returns JSON |
| **SQLite DB** | `carelite.db` file | Stores all persistent data (users, profiles, bookings) |
| **AI Scripts** | Python modules | Imported by Flask routes as helper functions (`from ai.smart_rating import calculate_initial_rating`) |

### 1.3 Where AI Scripts Fit

The AI components are **NOT** separate services. They are plain Python files in an `ai/` folder, imported directly into Flask:

```
carelite/
â”œâ”€â”€ app.py                  # Flask entry point
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ auth.py             # Login/Register endpoints
â”‚   â”œâ”€â”€ nurse.py            # Nurse profile endpoints
â”‚   â”œâ”€â”€ booking.py          # Booking flow endpoints
â”‚   â””â”€â”€ search.py           # Search & filter endpoints
â”œâ”€â”€ ai/
â”‚   â”œâ”€â”€ smart_rating.py     # Credential-based rating calculator (Scikit-learn)
â”‚   â””â”€â”€ face_verify.py      # ID vs Selfie comparison (face_recognition + OpenCV)
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ security.py         # Password hashing, input sanitization
â”‚   â””â”€â”€ validators.py       # Form validation helpers
â”œâ”€â”€ static/
â”‚   â”œâ”€â”€ css/
â”‚   â”œâ”€â”€ js/
â”‚   â””â”€â”€ images/
â”œâ”€â”€ templates/              # HTML pages (served by Flask or as static)
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ login.html
â”‚   â”œâ”€â”€ dashboard_patient.html
â”‚   â”œâ”€â”€ dashboard_nurse.html
â”‚   â”œâ”€â”€ search.html
â”‚   â””â”€â”€ booking.html
â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ schema.sql          # CREATE TABLE statements
â”‚   â””â”€â”€ seed.sql            # Sample data for testing
â””â”€â”€ carelite.db             # SQLite database file
```

### 1.4 Request Flow Example (Booking a Nurse)

```mermaid
sequenceDiagram
    participant Patient as Patient Browser
    participant API as Flask API
    participant DB as SQLite DB

    Patient->>API: POST /api/bookings {nurse_id, date, notes}
    API->>API: Validate session & input
    API->>DB: INSERT INTO bookings (...)
    DB-->>API: Success (booking_id)
    API-->>Patient: 201 {booking_id, status: "pending"}
    Note over Patient: UI updates to show "Pending" badge
```

---

## 2. Database Schema

### 2.1 Entity Relationship Diagram

```mermaid
erDiagram
    Users ||--o| NurseProfile : "has (if role=nurse)"
    Users ||--o| MedicalHistory : "has (if role=patient)"
    Users ||--o{ Bookings : "creates (as patient)"
    NurseProfile ||--o{ Bookings : "receives"

    Users {
        INTEGER id PK
        TEXT full_name
        TEXT email UK
        TEXT phone
        TEXT password_hash
        TEXT role "patient | nurse"
        TEXT national_id
        TEXT profile_photo_path
        TEXT created_at
    }

    NurseProfile {
        INTEGER id PK
        INTEGER user_id FK
        TEXT specialty
        TEXT zone
        REAL price_per_visit
        TEXT education_level
        INTEGER years_experience
        REAL smart_rating
        TEXT bio_ar
        INTEGER is_active "1=active, 0=inactive"
        TEXT id_photo_path
        TEXT selfie_photo_path
        INTEGER is_verified "0=pending, 1=verified, -1=failed"
    }

    MedicalHistory {
        INTEGER id PK
        INTEGER user_id FK
        TEXT chronic_diseases
        TEXT allergies
        TEXT blood_type
        TEXT current_medications
        TEXT notes
        TEXT updated_at
    }

    Bookings {
        INTEGER id PK
        INTEGER patient_id FK
        INTEGER nurse_id FK
        TEXT booking_date
        TEXT time_slot
        TEXT status "pending | accepted | rejected | completed | cancelled"
        TEXT patient_notes
        TEXT nurse_response
        TEXT created_at
        TEXT updated_at
    }
```

### 2.2 Table Details

#### `Users` â€” Core Identity Table
```sql
CREATE TABLE Users (
    id              INTEGER PRIMARY KEY AUTOINCREMENT,
    full_name       TEXT NOT NULL,
    email           TEXT NOT NULL UNIQUE,
    phone           TEXT NOT NULL,
    password_hash   TEXT NOT NULL,
    role            TEXT NOT NULL CHECK(role IN ('patient', 'nurse')),
    national_id     TEXT,
    profile_photo_path TEXT,
    created_at      TEXT DEFAULT (datetime('now'))
);
```

#### `NurseProfile` â€” Extended Nurse Data
```sql
CREATE TABLE NurseProfile (
    id                  INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id             INTEGER NOT NULL UNIQUE,
    specialty           TEXT NOT NULL,
    zone                TEXT NOT NULL,
    price_per_visit     REAL NOT NULL,
    education_level     TEXT,                -- e.g., "Ø¨ÙƒØ§Ù„ÙˆØ±ÙŠÙˆØ³ ØªÙ…Ø±ÙŠØ¶"
    years_experience    INTEGER DEFAULT 0,
    smart_rating        REAL DEFAULT 0.0,    -- AI-calculated initial rating
    bio_ar              TEXT,                -- Arabic bio
    is_active           INTEGER DEFAULT 1,   -- Toggle availability
    id_photo_path       TEXT,
    selfie_photo_path   TEXT,
    is_verified         INTEGER DEFAULT 0,   -- 0=pending, 1=verified, -1=failed
    FOREIGN KEY (user_id) REFERENCES Users(id) ON DELETE CASCADE
);
```

#### `MedicalHistory` â€” Patient Medical Passport
```sql
CREATE TABLE MedicalHistory (
    id                  INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id             INTEGER NOT NULL UNIQUE,
    chronic_diseases    TEXT,       -- JSON or comma-separated
    allergies           TEXT,
    blood_type          TEXT CHECK(blood_type IN ('A+','A-','B+','B-','AB+','AB-','O+','O-', NULL)),
    current_medications TEXT,
    notes               TEXT,
    updated_at          TEXT DEFAULT (datetime('now')),
    FOREIGN KEY (user_id) REFERENCES Users(id) ON DELETE CASCADE
);
```

#### `Bookings` â€” The Core Transaction
```sql
CREATE TABLE Bookings (
    id              INTEGER PRIMARY KEY AUTOINCREMENT,
    patient_id      INTEGER NOT NULL,
    nurse_id        INTEGER NOT NULL,
    booking_date    TEXT NOT NULL,
    time_slot       TEXT,
    status          TEXT DEFAULT 'pending' CHECK(status IN ('pending','accepted','rejected','completed','cancelled')),
    patient_notes   TEXT,
    nurse_response  TEXT,
    created_at      TEXT DEFAULT (datetime('now')),
    updated_at      TEXT DEFAULT (datetime('now')),
    FOREIGN KEY (patient_id) REFERENCES Users(id),
    FOREIGN KEY (nurse_id) REFERENCES NurseProfile(id)
);
```

### 2.3 Key Relationships Summary

| Relationship | Type | Description |
|---|---|---|
| `Users` â†’ `NurseProfile` | One-to-One | Only users with `role='nurse'` have a profile |
| `Users` â†’ `MedicalHistory` | One-to-One | Only users with `role='patient'` have medical data |
| `Users` (patient) â†’ `Bookings` | One-to-Many | A patient can create many bookings |
| `NurseProfile` â†’ `Bookings` | One-to-Many | A nurse can receive many bookings |

---

## 3. Weekly Work Breakdown (12 Weeks)

### Legend
| Emoji | Meaning |
|-------|---------|
| ğŸ—„ï¸ | Database Architect |
| ğŸ”Œ | API Developer |
| ğŸ¨ | UI Designer |
| âš¡ | Frontend Logic Integrator |
| ğŸ§  | Business Logic Engineer |
| ğŸ¤– | AI & Computer Vision Engineer |
| ğŸ”’ | Security & QA Engineer |

---

### Phase 1: Foundation (Weeks 1â€“4)
> **Goal:** Set up the environment, build the database, create basic API routes, and design static HTML pages.

---

#### Week 1 â€” Environment Setup & Planning

| Role | Tasks |
|------|-------|
| ğŸ—„ï¸ **Database Architect** | Install SQLite & DB Browser. Write the first draft of `schema.sql` with the `Users` table. Learn PRIMARY KEY vs FOREIGN KEY concepts. |
| ğŸ”Œ **API Developer** | Install Python, Flask, Postman. Create `app.py` with a "Hello World" route. Set up the project folder structure. |
| ğŸ¨ **UI Designer** | Set up VS Code with Live Server. Create `index.html` boilerplate with Arabic RTL support (`dir="rtl"`, `lang="ar"`). Start a CSS reset file. |
| âš¡ **Frontend Logic Integrator** | Learn `document.getElementById()`, event listeners. Write a simple test script that logs form data to the console. |
| ğŸ§  **Business Logic Engineer** | Install Python & pip. Research the nurse credentialing system in Egypt. Draft the "Smart Rating" formula on paper. |
| ğŸ¤– **AI & CV Engineer** | Install Python, OpenCV, `face_recognition` library. Run the library's "Hello World" example to verify setup. |
| ğŸ”’ **Security & QA** | Install all team tools. Create a shared Google Doc for bug tracking. Research `werkzeug.security` for password hashing. |

> [!TIP]
> **Week 1 Milestone:** Every team member should be able to run a "Hello World" in their domain.

---

#### Week 2 â€” Database & First API Routes

| Role | Tasks |
|------|-------|
| ğŸ—„ï¸ **Database Architect** | Finalize all 4 tables in `schema.sql`. Add `seed.sql` with 5 sample users (3 patients, 2 nurses). Test with DB Browser. |
| ğŸ”Œ **API Developer** | Create `POST /api/register` and `POST /api/login` routes. Connect Flask to SQLite using `sqlite3` module. Return JSON responses. |
| ğŸ¨ **UI Designer** | Design the **Login** and **Register** pages. Implement a consistent color scheme (medical theme: blues/greens). Add Google Fonts for Arabic (e.g., Cairo, Tajawal). |
| âš¡ **Frontend Logic Integrator** | Create `auth.js` â€” capture form submit, prevent default, log form values. Prepare the `fetch()` call structure (don't connect yet). |
| ğŸ§  **Business Logic Engineer** | Define the Smart Rating formula: `rating = (education_weight * edu_score) + (experience_weight * exp_score)`. Create a Python function `calculate_initial_rating(education_level, years_experience)`. |
| ğŸ¤– **AI & CV Engineer** | Write a standalone script `test_face_match.py` that loads two images and compares them using `face_recognition.compare_faces()`. Print match/no-match. |
| ğŸ”’ **Security & QA** | Implement `hash_password()` and `verify_password()` in `utils/security.py` using `werkzeug.security`. Write `sanitize_input()` to strip HTML tags. |

> [!TIP]
> **Week 2 Milestone:** Database is created. `/api/register` works in Postman.

---

#### Week 3 â€” Nurse Profile & Patient Medical Passport

| Role | Tasks |
|------|-------|
| ğŸ—„ï¸ **Database Architect** | Add indexes on `NurseProfile.zone` and `NurseProfile.specialty` for faster search queries. Write SQL queries for nurse CRUD operations. |
| ğŸ”Œ **API Developer** | Build `POST /api/nurse/profile` (create/update profile) and `GET /api/nurse/profile/:id`. Implement session management using Flask sessions. |
| ğŸ¨ **UI Designer** | Design the **Nurse Dashboard** page (profile form with fields: specialty, zone, price, bio, availability toggle). Design the **Medical Passport** form for patients. |
| âš¡ **Frontend Logic Integrator** | Build form validation in JS for the Nurse profile form (required fields, number range for price). Implement a client-side zone dropdown populated from a JS array. |
| ğŸ§  **Business Logic Engineer** | Create a list of Egyptian zones (`Ø§Ù„Ù‚Ø§Ù‡Ø±Ø© - Ù…Ø¯ÙŠÙ†Ø© Ù†ØµØ±`, `Ø§Ù„Ø¬ÙŠØ²Ø© - Ø§Ù„Ø¯Ù‚ÙŠ`, etc.) and nursing specialties. Build `zone_data.py` as a reference module. |
| ğŸ¤– **AI & CV Engineer** | Refine the face comparison script. Handle edge cases: no face detected, multiple faces detected. Add a confidence score output. |
| ğŸ”’ **Security & QA** | Test Register/Login API with invalid inputs (empty fields, duplicate emails, SQL injection attempts). Document all findings in the bug tracker. |

> [!TIP]
> **Week 3 Milestone:** Nurse can save a profile. Patient can fill the Medical Passport form.

---

#### Week 4 â€” Integration Checkpoint #1

| Role | Tasks |
|------|-------|
| ğŸ—„ï¸ **Database Architect** | Review all foreign key constraints. Write complex JOIN queries: "Get nurse profile with user info." Fix any schema issues discovered during API testing. |
| ğŸ”Œ **API Developer** | Create `GET /api/nurses/search?zone=X&specialty=Y` endpoint. Implement pagination (LIMIT/OFFSET). Add proper HTTP status codes to all routes. |
| ğŸ¨ **UI Designer** | Design the **Search Results** page (card layout showing nurse name, specialty, rating stars, price, zone). Create a reusable "Nurse Card" component in HTML/CSS. |
| âš¡ **Frontend Logic Integrator** | **CRITICAL INTEGRATION:** Connect Login form â†’ `POST /api/login` via `fetch()`. Store session/token. Redirect to correct dashboard based on `role`. |
| ğŸ§  **Business Logic Engineer** | Integrate `calculate_initial_rating()` into the nurse registration flow. When a nurse submits credentials, calculate and store the rating automatically. |
| ğŸ¤– **AI & CV Engineer** | Package the face comparison function into `ai/face_verify.py` with a clean API: `verify_identity(id_photo_path, selfie_path) -> {match: bool, confidence: float}`. |
| ğŸ”’ **Security & QA** | ğŸ”´ **Full Integration Test:** Test login flow end-to-end (UI â†’ API â†’ DB â†’ Response). Check for broken sessions, wrong redirects. Write a test checklist. |

> [!IMPORTANT]
> **Phase 1 Gate:** By end of Week 4, the team should have: a working database, login/register working end-to-end, and a nurse profile page. **Demo to your mentor!**

---

### Phase 2: Core Logic (Weeks 5â€“8)
> **Goal:** Connect the frontend and backend fully. Implement the search, booking flow, and nurse dashboard features.

---

#### Week 5 â€” Search System

| Role | Tasks |
|------|-------|
| ğŸ—„ï¸ **Database Architect** | Optimize search query: `SELECT * FROM NurseProfile JOIN Users ON ... WHERE zone=? AND specialty=? AND is_active=1 ORDER BY smart_rating DESC`. |
| ğŸ”Œ **API Developer** | Finalize `GET /api/nurses/search`. Add filters: `min_price`, `max_price`, `min_rating`. Return results sorted by `smart_rating`. |
| ğŸ¨ **UI Designer** | Build the **Search Page** with: Zone dropdown, Specialty dropdown, Price range inputs, and a "Cards Grid" for results. Add Arabic labels & placeholders. |
| âš¡ **Frontend Logic Integrator** | Wire the search form to `GET /api/nurses/search`. Dynamically render nurse cards from JSON response. Add a "Loading..." spinner. |
| ğŸ§  **Business Logic Engineer** | Build a **Symptom-to-Specialty mapper**: patient enters symptoms (checkboxes), the system suggests which nursing specialty they need. Store mapping in a Python dict. |
| ğŸ¤– **AI & CV Engineer** | Create the Flask route `POST /api/verify-identity` that receives two image files, calls `face_verify.py`, and returns the result. Handle file uploads. |
| ğŸ”’ **Security & QA** | Validate all search inputs (prevent SQL injection via parameterized queries). Test search with Arabic text inputs. Verify proper encoding (UTF-8). |

---

#### Week 6 â€” Booking Flow (Part 1: Request & Pending)

| Role | Tasks |
|------|-------|
| ğŸ—„ï¸ **Database Architect** | Write INSERT and SELECT queries for bookings. Create a query: "Get all bookings for nurse_id WHERE status='pending'". |
| ğŸ”Œ **API Developer** | Build `POST /api/bookings` (patient creates a booking). Build `GET /api/bookings/nurse/:id` (nurse sees incoming requests). |
| ğŸ¨ **UI Designer** | Design the **Booking Modal**: date picker, time slot selector, notes field, confirmation button. Design the nurse's **"Incoming Requests"** panel. |
| âš¡ **Frontend Logic Integrator** | Implement the booking modal: on "Book Now" click â†’ show modal â†’ collect data â†’ `POST /api/bookings`. Update UI to show "Request Sent âœ“". |
| ğŸ§  **Business Logic Engineer** | Implement booking validation logic: check if nurse is active, check for time slot conflicts (no double-booking). Return clear error messages in Arabic. |
| ğŸ¤– **AI & CV Engineer** | Add the identity verification step to the nurse registration flow. On the UI: "Upload ID" + "Take Selfie" â†’ Compare â†’ Show Result. |
| ğŸ”’ **Security & QA** | Ensure patients can only book active nurses. Ensure patients cannot book themselves. Test booking creation with invalid data. |

---

#### Week 7 â€” Booking Flow (Part 2: Accept/Reject & Contact Reveal)

| Role | Tasks |
|------|-------|
| ğŸ—„ï¸ **Database Architect** | Write UPDATE query for booking status. Create a view/query: "Get booking details with patient and nurse info joined." |
| ğŸ”Œ **API Developer** | Build `PATCH /api/bookings/:id/respond` (nurse accepts/rejects). Build `GET /api/bookings/:id` that reveals contact info ONLY when status is `accepted`. |
| ğŸ¨ **UI Designer** | Design the **Booking Details** card: shows status badge (colored), patient notes, and Accept/Reject buttons for nurse. Design the "Contact Revealed" view (phone + email appear after acceptance). |
| âš¡ **Frontend Logic Integrator** | Implement Accept/Reject buttons â†’ `PATCH /api/bookings/:id/respond`. On acceptance: reveal contact info section. On rejection: show "Rejected" badge + optional nurse response. |
| ğŸ§  **Business Logic Engineer** | Build notification logic: when a nurse responds, update a `notifications` flag or a simple last-updated field so the patient's dashboard can poll for changes. |
| ğŸ¤– **AI & CV Engineer** | Enhance the verification flow: add image quality checks (minimum resolution, face centered). Show clear error messages if the photo is blurry or no face is detected. |
| ğŸ”’ **Security & QA** | ğŸ”´ **Critical:** Verify that contact info (phone/email) is **NEVER** returned to the patient when the booking status is not `accepted`. Test this extensively. |

> [!CAUTION]
> **Security checkpoint:** Contact info leakage is the #1 privacy risk. The API must enforce this, not the frontend.

---

#### Week 8 â€” Dashboards & Integration Checkpoint #2

| Role | Tasks |
|------|-------|
| ğŸ—„ï¸ **Database Architect** | Write aggregate queries: "Count of bookings per status for a nurse," "Total completed bookings for a nurse." Optimize slow queries. |
| ğŸ”Œ **API Developer** | Build `GET /api/dashboard/patient` (my bookings list) and `GET /api/dashboard/nurse` (statistics + incoming requests). Add proper error handling to all routes. |
| ğŸ¨ **UI Designer** | Polish the **Patient Dashboard** (booking history list with status badges) and the **Nurse Dashboard** (stats cards + request list + availability toggle). |
| âš¡ **Frontend Logic Integrator** | Build dashboard rendering: fetch data on page load, populate cards and lists dynamically. Implement the nurse's availability toggle (`is_active` ON/OFF). |
| ğŸ§  **Business Logic Engineer** | Implement the **availability toggle** logic: when nurse goes inactive, all future pending bookings should be auto-cancelled (or flagged). |
| ğŸ¤– **AI & CV Engineer** | Test the full identity verification pipeline end-to-end. Prepare a demo with 3 test cases: matching photos, different people, blurry photo. |
| ğŸ”’ **Security & QA** | ğŸ”´ **Full System Test:** Test the complete flow Patient registers â†’ Searches â†’ Books â†’ Nurse Accepts â†’ Contact Revealed. Create a comprehensive test script. |

> [!IMPORTANT]
> **Phase 2 Gate:** By end of Week 8, the core booking flow should work end-to-end. **This is the "feature complete" milestone!**

---

### Phase 3: Intelligence & Polish (Weeks 9â€“12)
> **Goal:** Integrate AI features, harden security, fix bugs, polish UI, and prepare for final demo.

---

#### Week 9 â€” Smart Rating Integration

| Role | Tasks |
|------|-------|
| ğŸ—„ï¸ **Database Architect** | Add a `Ratings` table (optional): `(id, booking_id, patient_id, nurse_id, score, review_text, created_at)`. Write query to calculate average rating from patient reviews post-booking. |
| ğŸ”Œ **API Developer** | Build `POST /api/ratings` (patient rates a nurse after a completed booking). Build `GET /api/nurses/:id/ratings` (get a nurse's reviews). |
| ğŸ¨ **UI Designer** | Design the **Rating Component**: star selection (1â€“5), optional review text area. Design how ratings appear on nurse cards (stars + review count). |
| âš¡ **Frontend Logic Integrator** | Implement the star-rating widget (clickable stars using vanilla JS). Submit rating via `POST /api/ratings`. Update nurse cards to show the blended rating. |
| ğŸ§  **Business Logic Engineer** | Implement **blended rating**: `final_rating = (smart_rating * weight_ai + avg_patient_rating * weight_human) / total_weight`. New nurses rely more on smart_rating; as reviews increase, patient ratings dominate. |
| ğŸ¤– **AI & CV Engineer** | Fine-tune the `smart_rating.py` algorithm. Add weighting for Egyptian nursing certifications. Test with various credential combinations. |
| ğŸ”’ **Security & QA** | Ensure one patient can only rate a nurse once per booking. Validate rating score is between 1â€“5. Test for rating manipulation. |

---

#### Week 10 â€” Security Hardening & Arabic Polish

| Role | Tasks |
|------|-------|
| ğŸ—„ï¸ **Database Architect** | Add database backup script (copy `carelite.db`). Review all queries for SQL injection vulnerabilities. Add indexes where needed. |
| ğŸ”Œ **API Developer** | Add rate limiting to login endpoint (prevent brute force). Add CORS headers. Add centralized error handling (`@app.errorhandler`). |
| ğŸ¨ **UI Designer** | Full Arabic UI pass: verify all labels, error messages, and placeholders are in Arabic. Test RTL layout across pages. Add a consistent Footer and "About" page. |
| âš¡ **Frontend Logic Integrator** | Add **client-side error messages in Arabic** (e.g., "ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„"). Add localStorage for session persistence. Add a "loading" state for all API calls. |
| ğŸ§  **Business Logic Engineer** | Finalize the symptom-to-specialty mapper. Add at least 15 common symptom â†’ specialty mappings in Arabic. Make it easy to extend. |
| ğŸ¤– **AI & CV Engineer** | Add a simple **OCR prototype** (optional stretch goal): extract name from the National ID photo using `pytesseract` and compare it with the registered name. |
| ğŸ”’ **Security & QA** | ğŸ”´ **Security Audit:** Test all endpoints for: SQL injection, XSS, CSRF, broken access control. Document all findings. Fix critical issues. |

> [!WARNING]
> **Arabic text handling:** Ensure the database connection uses UTF-8 encoding. Test that Arabic data round-trips correctly: Input â†’ DB â†’ API â†’ Display.

---

#### Week 11 â€” Bug Fixing & Edge Cases

| Role | Tasks |
|------|-------|
| ğŸ—„ï¸ **Database Architect** | Fix any data integrity issues found in testing. Add `ON DELETE CASCADE` or `SET NULL` where missing. Verify seed data is comprehensive. |
| ğŸ”Œ **API Developer** | Fix all bugs from QA reports. Add missing validations. Ensure consistent JSON response format across ALL endpoints: `{success: bool, data: {}, message: ""}`. |
| ğŸ¨ **UI Designer** | Fix responsive design issues (test on mobile viewport). Add subtle animations (button hover effects, card transitions). Polish the color scheme for accessibility. |
| âš¡ **Frontend Logic Integrator** | Fix all frontend bugs. Add "empty state" views (e.g., "No nurses found" for empty search, "No bookings yet" for new patients). Handle network errors gracefully. |
| ğŸ§  **Business Logic Engineer** | Handle edge cases: What if a nurse has 0 experience? What if all nurses in a zone are inactive? Provide sensible defaults and helpful messages. |
| ğŸ¤– **AI & CV Engineer** | Handle AI edge cases: very low-resolution photos, photos with multiple faces, photos with sunglasses. Return user-friendly error messages in Arabic. |
| ğŸ”’ **Security & QA** | Final round of regression testing. Create a **Test Report Document** listing: Total tests, Passed, Failed, Known Issues. |

---

#### Week 12 â€” Final Demo Preparation

| Role | Tasks |
|------|-------|
| ğŸ—„ï¸ **Database Architect** | Prepare clean demo database with realistic sample data (10+ nurses, 5+ patients, diverse zones and specialties). Write a reset script. |
| ğŸ”Œ **API Developer** | Write API documentation (simple Markdown file listing all endpoints, methods, parameters, and example responses). Ensure the app starts cleanly with one command. |
| ğŸ¨ **UI Designer** | Create a **Landing Page** for CareLite (hero section, feature highlights, how-it-works section). Final visual polish across all pages. |
| âš¡ **Frontend Logic Integrator** | Full flow walkthrough: verify every button, every form, every redirect works. Fix any remaining JS errors in the console. |
| ğŸ§  **Business Logic Engineer** | Create a short **presentation/demo script** explaining the Smart Rating algorithm and Symptom Matcher. Include before/after examples. |
| ğŸ¤– **AI & CV Engineer** | Prepare a **live demo** of the face verification: show a match and a mismatch. Have fallback screenshots ready in case of hardware issues. |
| ğŸ”’ **Security & QA** | Final acceptance test: walk through the entire app as both a Patient and a Nurse. Sign off on the **Test Report**. Help prepare the demo presentation. |

> [!IMPORTANT]
> **Week 12 Deliverables:**
> 1. Working application (runs on `localhost`)
> 2. Database with sample data
> 3. API documentation (Markdown)
> 4. Test report
> 5. 10-minute demo presentation

---

## 4. Technical Guidance Notes

### 4.1 Role-Specific Learning Tips

#### ğŸ—„ï¸ Database Architect
> **Focus Concept:** Primary Keys vs. Foreign Keys.
> - A **Primary Key** is a unique identity for each row (like a National ID for each person).
> - A **Foreign Key** is a reference to another table's Primary Key (like writing your father's National ID on your birth certificate).
> - **Practice:** Draw the 4 tables on paper, draw arrows for Foreign Keys. This visual understanding is more important than the SQL syntax.

> **Recommended Tool:** [DB Browser for SQLite](https://sqlitebrowser.org/) â€” lets you see your data visually.

#### ğŸ”Œ API Developer
> **Focus Concept:** HTTP Methods and Status Codes.
> - `GET` = Read data, `POST` = Create data, `PATCH` = Update data, `DELETE` = Remove data.
> - `200` = OK, `201` = Created, `400` = Bad Request, `401` = Unauthorized, `404` = Not Found, `500` = Server Error.
> - **Practice:** Test every route in Postman BEFORE connecting it to the frontend. Postman is your best friend.

> **Golden Rule:** If you can't test it in Postman, the frontend integration will definitely fail.

#### ğŸ¨ UI Designer
> **Focus Concept:** CSS Flexbox + RTL Layout.
> - Arabic text flows Right-to-Left. Always set `dir="rtl"` on the `<html>` tag.
> - Use `margin-inline-start` / `margin-inline-end` instead of `margin-left` / `margin-right` for RTL compatibility.
> - **Practice:** Build one page at a time. Finish Login before starting Dashboard.

> **Font Recommendation:** Use Google Fonts â€” [Cairo](https://fonts.google.com/specimen/Cairo) or [Tajawal](https://fonts.google.com/specimen/Tajawal) for beautiful Arabic text.

#### âš¡ Frontend Logic Integrator
> **Focus Concept:** The `fetch()` API and Promises.
> ```javascript
> // This is the CORE PATTERN you'll use everywhere:
> fetch('/api/login', {
>     method: 'POST',
>     headers: { 'Content-Type': 'application/json' },
>     body: JSON.stringify({ email: email, password: password })
> })
> .then(response => response.json())
> .then(data => {
>     if (data.success) {
>         window.location.href = '/dashboard';
>     } else {
>         showError(data.message);
>     }
> })
> .catch(error => showError('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„'));
> ```
> **Practice:** Console.log EVERYTHING. Check the browser's Network tab to see API calls.

#### ğŸ§  Business Logic Engineer
> **Focus Concept:** Weighted Scoring Systems.
> - The Smart Rating formula should be transparent and fair:
>   ```python
>   def calculate_initial_rating(education_level, years_experience):
>       edu_scores = {
>           'diploma': 2.0,
>           'bachelor': 3.0,
>           'master': 4.0,
>           'phd': 4.5
>       }
>       edu_score = edu_scores.get(education_level, 2.0)
>       exp_score = min(years_experience * 0.15, 1.0)  # Max 1 point from experience
>       return round(min(edu_score + exp_score, 5.0), 1)  # Cap at 5.0
>   ```
> **Practice:** Test with real examples on paper before coding!

#### ğŸ¤– AI & Computer Vision Engineer
> **Focus Concept:** How Face Recognition Works at a High Level.
> - The library converts a face into 128 numbers (a "face encoding").
> - Two photos are "matched" if their encodings are close enough (Euclidean distance < threshold).
> - **Practice:** Start with the simplest example first. Don't try to build a full pipeline on Day 1.
> - **Hardware Note:** `face_recognition` uses `dlib`, which can be slow without GPU. On a student laptop, expect 2-5 seconds per comparison. That's fine for a demo.

#### ğŸ”’ Security & QA Engineer
> **Focus Concept:** Never Trust User Input.
> - Always hash passwords (never store plain text).
> - Always use **parameterized queries** (never concatenate user input into SQL).
>   ```python
>   # âŒ DANGEROUS - SQL Injection risk
>   cursor.execute(f"SELECT * FROM Users WHERE email = '{email}'")
>   
>   # âœ… SAFE - Parameterized query
>   cursor.execute("SELECT * FROM Users WHERE email = ?", (email,))
>   ```
> - **Practice:** Try to break the app! That's literally your job. Try weird inputs, empty fields, special characters, and Arabic text.

---

### 4.2 Egyptian Market Context Notes

#### ğŸŒ Arabic Language Support (All Roles)
| Concern | Solution |
|---------|----------|
| Arabic text in database | SQLite supports UTF-8 natively. Just store text normally. Verify with: `PRAGMA encoding;` should return `UTF-8`. |
| Arabic UI layout | Set `dir="rtl"` and `lang="ar"` on the `<html>` tag. Use CSS logical properties. |
| Arabic font rendering | Use Google Fonts: Cairo, Tajawal, or Noto Sans Arabic. |
| Arabic form validation | JS regex for Arabic: `/^[\u0600-\u06FF\s]+$/` to validate Arabic-only input. |
| Arabic error messages | Store all user-facing strings in an `messages_ar.py` or JSON file for consistency. |

#### ğŸ“ Zone System (Instead of Maps)
Since we're **NOT** using maps or GPS, zones are predefined text values in a dropdown:

```python
ZONES = [
    "Ø§Ù„Ù‚Ø§Ù‡Ø±Ø© - Ù…Ø¯ÙŠÙ†Ø© Ù†ØµØ±",
    "Ø§Ù„Ù‚Ø§Ù‡Ø±Ø© - Ø§Ù„Ù…Ø¹Ø§Ø¯ÙŠ",
    "Ø§Ù„Ù‚Ø§Ù‡Ø±Ø© - Ù…ØµØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©",
    "Ø§Ù„Ù‚Ø§Ù‡Ø±Ø© - Ø§Ù„ØªØ¬Ù…Ø¹ Ø§Ù„Ø®Ø§Ù…Ø³",
    "Ø§Ù„Ø¬ÙŠØ²Ø© - Ø§Ù„Ø¯Ù‚ÙŠ",
    "Ø§Ù„Ø¬ÙŠØ²Ø© - Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ÙŠÙ†",
    "Ø§Ù„Ø¬ÙŠØ²Ø© - Ù¦ Ø£ÙƒØªÙˆØ¨Ø±",
    "Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ© - Ø³Ù…ÙˆØ­Ø©",
    "Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ© - Ø§Ù„Ù…Ù†ØªØ²Ù‡",
    "Ø§Ù„Ù…Ù†ØµÙˆØ±Ø©",
    "Ø·Ù†Ø·Ø§",
    "Ø£Ø³ÙŠÙˆØ·",
]
```

#### ğŸ¥ Nursing Specialties
```python
SPECIALTIES = [
    "ØªÙ…Ø±ÙŠØ¶ Ø¹Ø§Ù…",          # General Nursing
    "ØªÙ…Ø±ÙŠØ¶ Ø£Ø·ÙØ§Ù„",        # Pediatric Nursing
    "ØªÙ…Ø±ÙŠØ¶ Ù…Ø³Ù†ÙŠÙ†",        # Geriatric Nursing
    "ØªÙ…Ø±ÙŠØ¶ Ø¬Ø±Ø§Ø­Ø©",        # Surgical Nursing
    "Ø¹Ù„Ø§Ø¬ Ø·Ø¨ÙŠØ¹ÙŠ",         # Physiotherapy
    "ØªÙ…Ø±ÙŠØ¶ Ù…Ù†Ø²Ù„ÙŠ",        # Home Care Nursing
    "Ø±Ø¹Ø§ÙŠØ© Ø¬Ø±ÙˆØ­",         # Wound Care
    "Ø­Ù‚Ù† ÙˆÙ…Ø­Ø§Ù„ÙŠÙ„",       # Injections & IV
]
```

#### ğŸ“± Offline-Friendly Design Tips
- Keep forms functional even with slow internet: validate on the client-side BEFORE sending.
- Use `localStorage` to save draft form data so patients don't lose their input.
- Keep images small (compress before upload, max 2MB).
- Test with Chrome DevTools Network throttling set to "Slow 3G."

---

### 4.3 Quick Reference: API Endpoints Summary

| Method | Endpoint | Description | Auth Required |
|--------|----------|-------------|:---:|
| `POST` | `/api/register` | Register new user | No |
| `POST` | `/api/login` | Log in | No |
| `POST` | `/api/logout` | Log out | Yes |
| `GET` | `/api/nurse/profile/:id` | Get nurse profile | Yes |
| `POST` | `/api/nurse/profile` | Create/Update nurse profile | Nurse |
| `PATCH` | `/api/nurse/toggle-active` | Toggle availability | Nurse |
| `GET` | `/api/nurses/search` | Search nurses by zone/specialty | Yes |
| `POST` | `/api/medical-history` | Save medical passport | Patient |
| `GET` | `/api/medical-history` | Get own medical history | Patient |
| `POST` | `/api/bookings` | Create a booking | Patient |
| `GET` | `/api/bookings/mine` | Get own bookings | Yes |
| `PATCH` | `/api/bookings/:id/respond` | Accept/Reject booking | Nurse |
| `GET` | `/api/bookings/:id` | Booking details (contact reveal if accepted) | Yes |
| `POST` | `/api/ratings` | Rate a nurse | Patient |
| `POST` | `/api/verify-identity` | Compare ID photo vs selfie | Nurse |
| `GET` | `/api/dashboard/patient` | Patient dashboard data | Patient |
| `GET` | `/api/dashboard/nurse` | Nurse dashboard data | Nurse |

---

> [!NOTE]
> **Final Advice to the Team:**
> 
> ğŸ¯ **Communication is everything.** The biggest risk isn't a bug â€” it's two students building incompatible pieces. Meet weekly. Share progress. Ask for help early.
> 
> ğŸ“– **Read each other's code.** The API Developer should understand the database schema. The Frontend Integrator should read the API docs. This cross-understanding prevents 90% of integration bugs.
> 
> ğŸ› **Bugs are normal.** Your first version will have bugs. Your second version will have fewer. That's how software works. Don't panic. Debug systematically: read the error message, check the line number, use `print()` statements.
> 
> ğŸ‡ªğŸ‡¬ **Be proud.** You're building something useful for your community. Keep the patient and the nurse in mind with every decision. Make it beautiful, make it work, make it help someone.

---

*Generated as an educational implementation plan for first-year CS students. CareLite is a learning projects â€” simplicity and understanding come first, complexity comes later.* âœ¨
